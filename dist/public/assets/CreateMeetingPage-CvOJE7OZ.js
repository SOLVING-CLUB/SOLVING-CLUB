import{u as F,g as O,r as d,j as e,D as E,B as m,L as M,A as J,C as f,b as C,d as v,a as w,k as r,I as x,T as D,S as L,l as R,m as T,n as I,o as S,p as c,t as h}from"./index-BeoiXK9q.js";function U(){const[P,g]=F(),l=O(),[p,u]=d.useState(!1),o=new URLSearchParams(window.location.search).get("project")||"",[s,a]=d.useState({title:"",description:"",project_id:o,scheduled_at:"",max_participants:50,settings:{record:!1,muteOnJoin:!0,videoOnJoin:!0,waitingRoom:!1,allowScreenShare:!0,allowChat:!0}}),[N,_]=d.useState([]);d.useEffect(()=>{y(),o&&l.from("projects").select("name").eq("id",o).single().then(({data:t})=>{t&&!s.title&&a(i=>({...i,title:`${t.name} Meeting`}))})},[o]);const y=async()=>{try{const{data:{user:t}}=await l.auth.getUser();if(!t)return;const{data:i,error:n}=await l.from("projects").select("id, name").eq("owner_id",t.id).order("name");if(n)throw n;i&&_(i)}catch(t){console.error("Error loading projects:",t)}},b=async t=>{if(t.preventDefault(),!s.title.trim()){h.error("Error","Meeting title is required");return}u(!0);try{const{data:{user:i}}=await l.auth.getUser();if(!i){h.error("Error","You must be logged in");return}const n={title:s.title.trim(),description:s.description.trim()||null,host_id:i.id,organizer_id:i.id,project_id:s.project_id||null,scheduled_at:s.scheduled_at||null,max_participants:s.max_participants,settings:s.settings};s.scheduled_at?n.meeting_date=s.scheduled_at:n.meeting_date=new Date().toISOString();const{data:k,error:j}=await l.from("meetings").insert(n).select().single();if(j)throw j;h.success("Success","Meeting created successfully!"),g(`/dashboard/meetings/${k.id}`)}catch(i){console.error("Error creating meeting:",i),h.error("Error",i.message||"Failed to create meeting")}finally{u(!1)}};return e.jsx(E,{children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(m,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(M,{href:"/dashboard/meetings",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create Meeting"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Schedule a new video meeting with your team"})]})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(v,{children:"Meeting Details"})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"title",children:"Title *"}),e.jsx(x,{id:"title",value:s.title,onChange:t=>a({...s,title:t.target.value}),placeholder:"Team Standup",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",value:s.description,onChange:t=>a({...s,description:t.target.value}),placeholder:"Meeting agenda and notes...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"project",children:"Link to Project (Optional)"}),e.jsxs(L,{value:s.project_id||"none",onValueChange:t=>a({...s,project_id:t==="none"?"":t}),children:[e.jsx(R,{children:e.jsx(T,{placeholder:"Select a project"})}),e.jsxs(I,{children:[e.jsx(S,{value:"none",children:"No project"}),N.map(t=>e.jsx(S,{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"scheduled_at",children:"Scheduled Time (Optional)"}),e.jsx(x,{id:"scheduled_at",type:"datetime-local",value:s.scheduled_at,onChange:t=>a({...s,scheduled_at:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"max_participants",children:"Max Participants"}),e.jsx(x,{id:"max_participants",type:"number",min:"2",max:"100",value:s.max_participants,onChange:t=>a({...s,max_participants:parseInt(t.target.value)||50})})]})]})]}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(v,{children:"Meeting Settings"})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"muteOnJoin",checked:s.settings.muteOnJoin,onCheckedChange:t=>a({...s,settings:{...s.settings,muteOnJoin:t}})}),e.jsx(r,{htmlFor:"muteOnJoin",className:"cursor-pointer",children:"Mute participants on join"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"videoOnJoin",checked:s.settings.videoOnJoin,onCheckedChange:t=>a({...s,settings:{...s.settings,videoOnJoin:t}})}),e.jsx(r,{htmlFor:"videoOnJoin",className:"cursor-pointer",children:"Enable video on join"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"waitingRoom",checked:s.settings.waitingRoom,onCheckedChange:t=>a({...s,settings:{...s.settings,waitingRoom:t}})}),e.jsx(r,{htmlFor:"waitingRoom",className:"cursor-pointer",children:"Enable waiting room"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"allowScreenShare",checked:s.settings.allowScreenShare,onCheckedChange:t=>a({...s,settings:{...s.settings,allowScreenShare:t}})}),e.jsx(r,{htmlFor:"allowScreenShare",className:"cursor-pointer",children:"Allow screen sharing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"allowChat",checked:s.settings.allowChat,onCheckedChange:t=>a({...s,settings:{...s.settings,allowChat:t}})}),e.jsx(r,{htmlFor:"allowChat",className:"cursor-pointer",children:"Enable chat"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"record",checked:s.settings.record,onCheckedChange:t=>a({...s,settings:{...s.settings,record:t}})}),e.jsx(r,{htmlFor:"record",className:"cursor-pointer",children:"Record meeting (coming soon)"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{type:"submit",disabled:p,className:"flex-1",children:p?"Creating...":"Create Meeting"}),e.jsx(m,{type:"button",variant:"outline",onClick:()=>g("/dashboard/meetings"),children:"Cancel"})]})]})]})})}export{U as default};
